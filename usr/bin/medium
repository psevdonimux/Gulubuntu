#!/bin/sh
MEDIUM_FREQ=$(cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies | tr ' ' '\n' | sort -rn | sed -n '2p')
echo 1 | sudo tee /sys/devices/system/cpu/cpu*/online & 
sleep 2 #fix
echo userspace | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor &
echo $MEDIUM_FREQ | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_setspeed & 
echo $MEDIUM_FREQ | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_max_freq & 
echo $MEDIUM_FREQ | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_min_freq & 
echo 0 | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/boost & 
echo 0 | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/cpb & 
echo auto | sudo tee /sys/class/drm/card0/device/power_dpm_force_performance_level &
echo 0 | sudo tee /proc/sys/vm/stat_interval &
echo 6000 | sudo tee /proc/sys/vm/dirty_writeback_centisecs &
echo 1 | sudo tee /sys/module/processor/parameters/latency_factor &
for cpu in /sys/devices/system/cpu/cpu*/cpuidle/state*/disable; do
  echo 1 | sudo tee $cpu
done
for cpu in /sys/devices/system/cpu/cpu*/power/control; do
  echo on | sudo tee $cpu
done
